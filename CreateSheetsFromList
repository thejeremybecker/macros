Sub CreateSheetsFromList()

'Copies "Master" tab and renames tabs to cells in range beginning in RCM cell A5 
'Only loops through visible rows (hidden rows do not get tabs created)
'Named ranges can create error (click-through) when ranges are duplicated. To resolve, delete named ranges first in Name Manager.
'Be sure 'Master (2)' sheet does not exist first.
'Reset VBA project first to clear any variables (Reset/stop button in VBA editor)'
'RACM needs to be first tab; Master needs to be second tab

'To build an audit workbook:
'1) start with RACM - filter or hide controls that don't need tabs
'2) create a master control test sheet and name "Master"
'3) use VLOOKUP based on a control number cell in the master worksheet to look up control language and other attributes
'5) run CreateSheetsFromList

Dim ws1 As Worksheet
Set ws1 = ActiveWorkbook.Worksheets("Master")
Dim MyCell As Range, MyRange As Range
Set MyRange = Sheets("RACM").Range("A8")
Set MyRange = Range(MyRange, MyRange.End(xlDown))

For Each MyCell In MyRange
	If MyCell.EntireRow.Hidden = False Then 'only includes non-hidden rows
		ws1.Copy ActiveWorkbook.Sheets(Sheets.Count)
		ActiveWorkbook.Worksheets("Master (2)").Name = MyCell.Value 
		'renames sheets to match row in RCM
	End If
Next MyCell

Sheets("Master").Select
Sheets("Master").Move Before:=Sheets(2)

End Sub
